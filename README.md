
# Решение задачи линейного программирования симплекс-методом

## Ф.И.О.
Захматов Юрий Дмитриевич

## Поток
МЕТОПТ 1.2

## Вариант 

15: 
Максимизировать 
Z = 2x1 + x2 + 3x3 + 4x4 

при условиях:

x1 + 2x2 + x4 <= 10


x1 + x3 + x4 = 7

x2 + 2x3 >= 5



## Краткое описание алгоритма решения ЗЛП

### Блок-схема алгоритма симплекс-метода

```mermaid
flowchart TD
    A[НАЧАЛО] --> B[Чтение данных из input.txt]
    B --> C[Проверка искусственных переменных]
    C --> D{Есть искусственные<br/>переменные?}
    
    D -->|Да| E[ДВУХФАЗНЫЙ СИМПЛЕКС-МЕТОД]
    D -->|Нет| F[ОДНОФАЗНЫЙ СИМПЛЕКС-МЕТОД]
    
    E --> G[ФАЗА 1:<br/>Минимизация суммы<br/>искусственных переменных]
    G --> H{min > 0?}
    H -->|Да| I[Задача не имеет решения]
    H -->|Нет| J[ФАЗА 2:<br/>Максимизация исходной<br/>целевой функции]
    
    F --> K[Основной цикл симплекс-метода]
    J --> K
    
    subgraph K [ОСНОВНОЙ ЦИКЛ]
        L[Проверка оптимальности] --> M{Все коэффициенты ≥ 0?}
        M -->|Да| N[Решение оптимально]
        M -->|Нет| O[Выбор входящей переменной<br/>min отрицательный коэффициент]
        O --> P[Выбор выходящей переменной<br/>min отношение b/a]
        P --> Q[Пересчет таблицы<br/>методом Жордана-Гаусса]
        Q --> L
    end
    
    N --> R[Вывод оптимального решения<br/>и проверка ограничений]
    R --> S[КОНЕЦ]
    I --> S
```
# Инструкция по развертыванию и запуску программы

Требования

- Python 3.10 или выше

- Библиотека NumPy

- Библиотека SciPy (для тестирования)

# Установка зависимостей

```
pip install -r requirements.txt
```

# Как работает

1. В файле `input.txt` вводим значения в следующем формате:

```text
2 1 3 4                # Коэффициенты целевой функции
1 2 0 1                # Матрица ограничений (строка 1)
1 0 1 1                # Матрица ограничений (строка 2)  
0 1 2 0                # Матрица ограничений (строка 3)
10 7 5                 # Правые части ограничений
<= = >=                # Типы ограничений
```

2. Запускаем программу

```
python simplex.py
```

3. Вывод программы:

```text
"E:\ITMO\3 course\МетОпт\МетОпт\.venv\Scripts\python.exe" "E:\ITMO\3 course\МетОпт\МетОпт\ITMO_MetOptRep\Lab1\simplex.py" 
Чтение данных из файла input.txt...
=== ЗАДАЧА ЛИНЕЙНОГО ПРОГРАММИРОВАНИЯ ===
Целевая функция: max [2. 1. 3. 4.]·x
Ограничения:
[1. 2. 0. 1.]·x <= 10.0
[1. 0. 1. 1.]·x = 7.0
[0. 1. 2. 0.]·x >= 5.0

Дополнительные переменные: 1 slack, 1 surplus, 2 artificial
Общее количество переменных: 8
1. Расширенная матрица системы ограничений:
   x1 x2 x3 x4 x5 x6 x7 x8   B
    1   2   0   1   1   0   0   0  10
    1   0   1   1   0   0   1   0   7
    0   1   2   0   0  -1   0   1   5
   Базисные переменные: ['x5', 'x7', 'x8']

2. Используем двухфазный симплекс-метод (есть искусственные переменные)
   Фаза 1: минимизация суммы искусственных переменных
   Начальная таблица фазы 1:
   Базис     B    x    1 x    2 x    3 x    4 x    5 x    6 x    7 x    8 
   x 5    10.00   1.00   2.00   0.00   1.00   1.00   0.00   0.00   0.00
   x 7     7.00   1.00   0.00   1.00   1.00   0.00   0.00   1.00   0.00
   x 8     5.00   0.00   1.00   2.00   0.00   0.00  -1.00   0.00   1.00
   F       -12.00  -1.00  -1.00  -3.00  -1.00   0.00   1.00   0.00   0.00

   Фаза 1: итерация 1, вводим x3
   Выводим x8
   Базис     B    x    1 x    2 x    3 x    4 x    5 x    6 x    7 x    8 
   x 5    10.00   1.00   2.00   0.00   1.00   1.00   0.00   0.00   0.00
   x 7     4.50   1.00  -0.50   0.00   1.00   0.00   0.50   1.00  -0.50
   x 3     2.50   0.00   0.50   1.00   0.00   0.00  -0.50   0.00   0.50
   F        -4.50  -1.00   0.50   0.00  -1.00   0.00  -0.50   0.00   1.50

   Фаза 1: итерация 2, вводим x1
   Выводим x7
   Базис     B    x    1 x    2 x    3 x    4 x    5 x    6 x    7 x    8 
   x 5     5.50   0.00   2.50   0.00   0.00   1.00  -0.50  -1.00   0.50
   x 1     4.50   1.00  -0.50   0.00   1.00   0.00   0.50   1.00  -0.50
   x 3     2.50   0.00   0.50   1.00   0.00   0.00  -0.50   0.00   0.50
   F         0.00   0.00   0.00   0.00   0.00   0.00   0.00   1.00   1.00

   Фаза 1: достигнуто оптимальное решение на итерации 3!
   ✓ Фаза 1 завершена, найдено допустимое базисное решение
   Фаза 2: максимизация исходной целевой функции
   Начальная таблица фазы 2:
   Базис     B    x    1 x    2 x    3 x    4 x    5 x    6 
   x 5     5.50   0.00   2.50   0.00   0.00   1.00  -0.50
   x 1     4.50   1.00  -0.50   0.00   1.00   0.00   0.50
   x 3     2.50   0.00   0.50   1.00   0.00   0.00  -0.50
   F       -16.50  -4.00  -1.50  -6.00  -6.00   0.00   0.50

   Фаза 2: итерация 1, вводим x3
   Выводим x3
   Базис     B    x    1 x    2 x    3 x    4 x    5 x    6 
   x 5     5.50   0.00   2.50   0.00   0.00   1.00  -0.50
   x 1     4.50   1.00  -0.50   0.00   1.00   0.00   0.50
   x 3     2.50   0.00   0.50   1.00   0.00   0.00  -0.50
   F        -1.50  -4.00   1.50   0.00  -6.00   0.00  -2.50

   Фаза 2: итерация 2, вводим x4
   Выводим x1
   Базис     B    x    1 x    2 x    3 x    4 x    5 x    6 
   x 5     5.50   0.00   2.50   0.00   0.00   1.00  -0.50
   x 4     4.50   1.00  -0.50   0.00   1.00   0.00   0.50
   x 3     2.50   0.00   0.50   1.00   0.00   0.00  -0.50
   F        25.50   2.00  -1.50   0.00   0.00   0.00   0.50

   Фаза 2: итерация 3, вводим x2
   Выводим x5
   Базис     B    x    1 x    2 x    3 x    4 x    5 x    6 
   x 2     2.20   0.00   1.00   0.00   0.00   0.40  -0.20
   x 4     5.60   1.00   0.00   0.00   1.00   0.20   0.40
   x 3     1.40   0.00   0.00   1.00   0.00  -0.20  -0.40
   F        28.80   2.00   0.00   0.00   0.00   0.60   0.20

   Фаза 2: достигнуто оптимальное решение на итерации 4!

============================================================
РЕЗУЛЬТАТ РЕШЕНИЯ ЗАДАЧИ ЛИНЕЙНОГО ПРОГРАММИРОВАНИЯ
============================================================
✓ ОПТИМАЛЬНОЕ РЕШЕНИЕ НАЙДЕНО
Значения переменных:
  x1 = 0.000000
  x2 = 2.200000
  x3 = 1.400000
  x4 = 5.600000
Максимальное значение целевой функции: 28.800000

Проверка выполнения ограничений:
  ✓ [1.0, 2.0, 0.0, 1.0]·x = 10.000000 <= 10.0
  ✓ [1.0, 0.0, 1.0, 1.0]·x = 7.000000 = 7.0
  ✓ [0.0, 1.0, 2.0, 0.0]·x = 5.000000 >= 5.0

✓ Все ограничения выполнены!

Process finished with exit code 0
```

4. Проверяем через `test.py` верность решения с помощью библиотеки `scipy`

```text
"E:\ITMO\3 course\МетОпт\МетОпт\.venv\Scripts\python.exe" "E:\ITMO\3 course\МетОпт\МетОпт\ITMO_MetOptRep\Lab1\test.py" 
Чтение данных из файла input.txt...
=== РЕШЕНИЕ С ПОМОЩЬЮ SCIPY ===
Целевая функция: max [2.0, 1.0, 3.0, 4.0]·x
Ограничения:
  [1.0, 2.0, 0.0, 1.0]·x <= 10.0
  [1.0, 0.0, 1.0, 1.0]·x = 7.0
  [0.0, 1.0, 2.0, 0.0]·x >= 5.0

Преобразованная задача для scipy:
Целевая функция: min [-2.0, -1.0, -3.0, -4.0]·x
Ограничения-неравенства (<=):
  [1.0, 2.0, 0.0, 1.0]·x <= 10.0
  [-0.0, -1.0, -2.0, -0.0]·x <= -5.0
Ограничения-равенства (=):
  [1.0, 0.0, 1.0, 1.0]·x = 7.0


============================================================
РЕЗУЛЬТАТЫ РЕШЕНИЯ
============================================================
✓ ОПТИМАЛЬНОЕ РЕШЕНИЕ НАЙДЕНО
Статус решения: Optimization terminated successfully. (HiGHS Status 7: Optimal)
Оптимальное значение целевой функции: 28.800000

Оптимальные значения переменных:
  x1 = 0.000000
  x2 = 2.200000
  x3 = 1.400000
  x4 = 5.600000

Проверка выполнения ограничений:
  ✓ [1.0, 2.0, 0.0, 1.0]·x = 10.000000 <= 10.0
  ✓ [1.0, 0.0, 1.0, 1.0]·x = 7.000000 = 7.0
  ✓ [0.0, 1.0, 2.0, 0.0]·x = 5.000000 >= 5.0

✓ Все ограничения выполнены!

Дополнительная информация:
  Количество итераций: 0
  Время решения: N/A сек

Process finished with exit code 0
```

Как видно решения сошлись.


# Вывод

Работа над реализацией симплекс-метода оказалась чрезвычайно полезной для глубокого понимания методов оптимизации. Несмотря на наличие готовых библиотек типа SciPy, самостоятельная реализация позволила:

- По-настоящему понять механизм работы алгоритма на уровне отдельных операций с матрицами

- Освоить обработку краевых случаев и особых ситуаций, которые часто возникают в реальных задачах

- Развить навыки работы с матричными операциями и численными методами в Python

- Получить бесценный опыт решения сложных алгоритмических задач и их отладки

Наибольшую сложность представляла корректная реализация двухфазного метода, но именно этот опыт оказался наиболее ценным с точки зрения обучения. Понимание того, как искусственные переменные влияют на процесс решения и как правильно переходить от фазы 1 к фазе 2, дало глубокое представление о внутренней работе алгоритмов оптимизации.

Работа также показала важность тестирования и валидации результатов, особенно при реализации численных методов, где даже небольшие ошибки могут привести к совершенно неверным решениям.
